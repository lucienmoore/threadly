{"version":3,"names":["_Symbol$for","_classPrivateFieldLooseBase","receiver","privateKey","Object","prototype","hasOwnProperty","call","TypeError","id","_classPrivateFieldLooseKey","name","UserFacingApiError","pRetry","AbortError","fetchWithNetworkError","ErrorWithCause","emitSocketProgress","getSocketHost","AuthError","packageJson","stripSlash","url","replace","retryCount","socketActivityTimeoutMs","authErrorStatusCode","HttpError","Error","constructor","_ref","statusCode","message","handleJSONResponse","res","status","ok","json","errMsg","statusText","errData","requestId","cause","_companionHeaders","_getUrl","_requestSocketToken","_awaitRemoteFileUpload","Symbol","for","RequestClient","uppy","opts","defineProperty","value","_awaitRemoteFileUpload2","_getUrl2","writable","_ref2","file","postBody","signal","remote","post","body","token","onReceiveResponse","bind","companionHeaders","setCompanionHeaders","headers","hostname","companion","getState","host","companionUrl","emptyBody","defaultHeaders","Accept","undefined","_ref3","state","has","get","setState","request","_ref4","path","method","data","skipPostResponse","response","credentials","companionCookiesRule","JSON","stringify","err","isAuthError","options","delete","uploadRemoteFile","reqBody","_this","getQueue","_this$uppy$getFile","existingServerToken","getFile","serverToken","log","queue","queueRequestSocketToken","wrapPromiseFunction","arguments","outerErr","isRetryableHttpError","includes","priority","abortOn","setFileState","retries","onFailedAttempt","emit","test","_ref5","removeEventHandlers","capabilities","Promise","resolve","reject","socket","socketAbortController","activityTimeout","isPaused","socketSend","action","payload","readyState","OPEN","_socket","String","send","sendState","resumableUploads","createWebsocket","abort","AbortController","onFatalError","_socketAbortControlle","resetActivityTimeout","clearTimeout","setTimeout","reconnectWebsocket","resolveSocket","rejectSocket","WebSocket","addEventListener","error","close","e","parse","_socketAbortControlle2","uploadURL","assign","closeSocket","aborted","pause","newPausedState","_socketAbortControlle3","onFileRemove","targetFile","_socketAbortControlle4","individualCancellation","onCancelAll","_ref6","_socketAbortControlle5","reason","onFilePausedChange","targetFileId","onPauseAll","onResumeAll","on","off","_socketAbortControlle6","VERSION","version"],"sources":["RequestClient.js"],"sourcesContent":["'use strict'\n\nimport UserFacingApiError from '@uppy/utils/lib/UserFacingApiError'\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport pRetry, { AbortError } from 'p-retry'\n\nimport fetchWithNetworkError from '@uppy/utils/lib/fetchWithNetworkError'\nimport ErrorWithCause from '@uppy/utils/lib/ErrorWithCause'\nimport emitSocketProgress from '@uppy/utils/lib/emitSocketProgress'\nimport getSocketHost from '@uppy/utils/lib/getSocketHost'\n\nimport AuthError from './AuthError.js'\n\nimport packageJson from '../package.json'\n\n// Remove the trailing slash so we can always safely append /xyz.\nfunction stripSlash(url) {\n  return url.replace(/\\/$/, '')\n}\n\nconst retryCount = 10 // set to a low number, like 2 to test manual user retries\nconst socketActivityTimeoutMs = 5 * 60 * 1000 // set to a low number like 10000 to test this\n\nexport const authErrorStatusCode = 401\n\nclass HttpError extends Error {\n  statusCode\n\n  constructor({ statusCode, message }) {\n    super(message)\n    this.name = 'HttpError'\n    this.statusCode = statusCode\n  }\n}\n\nasync function handleJSONResponse(res) {\n  if (res.status === authErrorStatusCode) {\n    throw new AuthError()\n  }\n\n  if (res.ok) {\n    return res.json()\n  }\n\n  let errMsg = `Failed request with status: ${res.status}. ${res.statusText}`\n  let errData\n  try {\n    errData = await res.json()\n\n    if (errData.message) errMsg = `${errMsg} message: ${errData.message}`\n    if (errData.requestId) errMsg = `${errMsg} request-Id: ${errData.requestId}`\n  } catch (cause) {\n    // if the response contains invalid JSON, let's ignore the error data\n    throw new Error(errMsg, { cause })\n  }\n\n  if (res.status >= 400 && res.status <= 499 && errData.message) {\n    throw new UserFacingApiError(errData.message)\n  }\n\n  throw new HttpError({ statusCode: res.status, message: errMsg })\n}\n\nexport default class RequestClient {\n  static VERSION = packageJson.version\n\n  #companionHeaders\n\n  constructor(uppy, opts) {\n    this.uppy = uppy\n    this.opts = opts\n    this.onReceiveResponse = this.onReceiveResponse.bind(this)\n    this.#companionHeaders = opts?.companionHeaders\n  }\n\n  setCompanionHeaders(headers) {\n    this.#companionHeaders = headers\n  }\n\n  [Symbol.for('uppy test: getCompanionHeaders')]() {\n    return this.#companionHeaders\n  }\n\n  get hostname() {\n    const { companion } = this.uppy.getState()\n    const host = this.opts.companionUrl\n    return stripSlash(companion && companion[host] ? companion[host] : host)\n  }\n\n  async headers (emptyBody = false) {\n    const defaultHeaders = {\n      Accept: 'application/json',\n      ...(emptyBody ? undefined : {\n        // Passing those headers on requests with no data forces browsers to first make a preflight request.\n        'Content-Type': 'application/json',\n      }),\n    }\n\n    return {\n      ...defaultHeaders,\n      ...this.#companionHeaders,\n    }\n  }\n\n  onReceiveResponse({ headers }) {\n    const state = this.uppy.getState()\n    const companion = state.companion || {}\n    const host = this.opts.companionUrl\n\n    // Store the self-identified domain name for the Companion instance we just hit.\n    if (headers.has('i-am') && headers.get('i-am') !== companion[host]) {\n      this.uppy.setState({\n        companion: { ...companion, [host]: headers.get('i-am') },\n      })\n    }\n  }\n\n  #getUrl(url) {\n    if (/^(https?:|)\\/\\//.test(url)) {\n      return url\n    }\n    return `${this.hostname}/${url}`\n  }\n\n  /** @protected */\n  async request({ path, method = 'GET', data, skipPostResponse, signal }) {\n    try {\n      const headers = await this.headers(!data)\n      const response = await fetchWithNetworkError(this.#getUrl(path), {\n        method,\n        signal,\n        headers,\n        credentials: this.opts.companionCookiesRule || 'same-origin',\n        body: data ? JSON.stringify(data) : null,\n      })\n      if (!skipPostResponse) this.onReceiveResponse(response)\n\n      return await handleJSONResponse(response)\n    } catch (err) {\n      // pass these through\n      if (err.isAuthError || err.name === 'UserFacingApiError' || err.name === 'AbortError') throw err\n\n      throw new ErrorWithCause(`Could not ${method} ${this.#getUrl(path)}`, {\n        cause: err,\n      })\n    }\n  }\n\n  async get(path, options = undefined) {\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = { skipPostResponse: options }\n    return this.request({ ...options, path })\n  }\n\n  async post(path, data, options = undefined) {\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = { skipPostResponse: options }\n    return this.request({ ...options, path, method: 'POST', data })\n  }\n\n  async delete(path, data = undefined, options) {\n    // TODO: remove boolean support for options that was added for backward compatibility.\n    // eslint-disable-next-line no-param-reassign\n    if (typeof options === 'boolean') options = { skipPostResponse: options }\n    return this.request({ ...options, path, method: 'DELETE', data })\n  }\n\n  /**\n   * Remote uploading consists of two steps:\n   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n   * Then companion will halt the upload until:\n   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n   * uploading or is otherwise done (failed, canceled)\n   * \n   * @param {*} file \n   * @param {*} reqBody \n   * @param {*} options \n   * @returns \n   */\n  async uploadRemoteFile(file, reqBody, options = {}) {\n    try {\n      const { signal, getQueue } = options\n\n      return await pRetry(async () => {\n        // if we already have a serverToken, assume that we are resuming the existing server upload id\n        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n        if (existingServerToken != null) {\n          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n        }\n\n        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n          try {\n            return await this.#requestSocketToken(...args)\n          } catch (outerErr) {\n            // throwing AbortError will cause p-retry to stop retrying\n            if (outerErr.isAuthError) throw new AbortError(outerErr)\n\n            if (outerErr.cause == null) throw outerErr\n            const err = outerErr.cause\n\n            const isRetryableHttpError = () => (\n              [408, 409, 429, 418, 423].includes(err.statusCode)\n              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n            )\n            if (err.name === 'HttpError' && !isRetryableHttpError()) throw new AbortError(err);\n\n            // p-retry will retry most other errors,\n            // but it will not retry TypeError (except network error TypeErrors)\n            throw err\n          }\n        }, { priority: -1 })\n\n        const serverToken = await queueRequestSocketToken({ file, postBody: reqBody, signal }).abortOn(signal)\n\n        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n\n        this.uppy.setFileState(file.id, { serverToken })\n\n        return this.#awaitRemoteFileUpload({\n          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n          queue: getQueue(),\n          signal\n        })\n      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n    } catch (err) {\n      // this is a bit confusing, but note that an error with the `name` prop set to 'AbortError' (from AbortController)\n      // is not the same as `p-retry` `AbortError`\n      if (err.name === 'AbortError') {\n        // The file upload was aborted, itâ€™s not an error\n        return undefined\n      }\n\n      this.uppy.emit('upload-error', file, err)\n      throw err\n    }\n  }\n\n  #requestSocketToken = async ({ file, postBody, signal }) => {\n    if (file.remote.url == null) {\n      throw new Error('Cannot connect to an undefined URL')\n    }\n\n    const res = await this.post(file.remote.url, {\n      ...file.remote.body,\n      ...postBody,\n    }, signal)\n\n    return res.token\n  }\n\n  /**\n   * This method will ensure a websocket for the specified file and returns a promise that resolves\n   * when the file has finished downloading, or rejects if it fails.\n   * It will retry if the websocket gets disconnected\n   * \n   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n   */\n  async #awaitRemoteFileUpload({ file, queue, signal }) {\n    let removeEventHandlers\n\n    const { capabilities } = this.uppy.getState()\n\n    try {\n      return await new Promise((resolve, reject) => {\n        const token = file.serverToken\n        const host = getSocketHost(file.remote.companionUrl)\n\n        /** @type {WebSocket} */\n        let socket\n        /** @type {AbortController?} */\n        let socketAbortController\n        let activityTimeout\n\n        let { isPaused } = file\n\n        const socketSend = (action, payload) => {\n          if (socket == null || socket.readyState !== socket.OPEN) {\n            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n            return\n          }\n\n          socket.send(JSON.stringify({\n            action,\n            payload: payload ?? {},\n          }))\n        };\n\n        function sendState() {\n          if (!capabilities.resumableUploads) return;\n\n          if (isPaused) socketSend('pause')\n          else socketSend('resume')\n        }\n\n        const createWebsocket = async () => {\n          if (socketAbortController) socketAbortController.abort()\n          socketAbortController = new AbortController()\n\n          const onFatalError = (err) => {\n            // Remove the serverToken so that a new one will be created for the retry.\n            this.uppy.setFileState(file.id, { serverToken: null })\n            socketAbortController?.abort?.()\n            reject(err)\n          }\n\n          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n          function resetActivityTimeout() {\n            clearTimeout(activityTimeout)\n            if (isPaused) return\n            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n          }\n\n          try {\n            await queue.wrapPromiseFunction(async () => {\n              // eslint-disable-next-line promise/param-names\n              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n                socket = new WebSocket(`${host}/api/${token}`)\n\n                resetActivityTimeout()\n\n                socket.addEventListener('close', () => {\n                  socket = undefined\n                  rejectSocket(new Error('Socket closed unexpectedly'))\n                })\n\n                socket.addEventListener('error', (error) => {\n                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n                  socket.close() // will 'close' event to be emitted\n                })\n\n                socket.addEventListener('open', () => {\n                  sendState()\n                })\n\n                socket.addEventListener('message', (e) => {\n                  resetActivityTimeout()\n\n                  try {\n                    const { action, payload } = JSON.parse(e.data)\n\n                    switch (action) {\n                      case 'progress': {\n                        emitSocketProgress(this, payload, file)\n                        break;\n                      }\n                      case 'success': {\n                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n                        socketAbortController?.abort?.()\n                        resolve()\n                        break;\n                      }\n                      case 'error': {\n                        const { message } = payload.error\n                        throw Object.assign(new Error(message), { cause: payload.error })\n                      }\n                      default:\n                        this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n                    }\n                  } catch (err) {\n                    onFatalError(err)\n                  }\n                })\n\n                const closeSocket = () => {\n                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n                  clearTimeout(activityTimeout)\n                  if (socket) socket.close()\n                  socket = undefined\n                }\n\n                socketAbortController.signal.addEventListener('abort', () => {\n                  closeSocket()\n                })\n              })\n\n              await pRetry(reconnectWebsocket, {\n                retries: retryCount,\n                signal: socketAbortController.signal,\n                onFailedAttempt: () => {\n                  if (socketAbortController.signal.aborted) return // don't log in this case\n                  this.uppy.log(`Retrying websocket ${file.id}`, 'info')\n                },\n              });\n            })().abortOn(socketAbortController.signal);\n          } catch (err) {\n            if (socketAbortController.signal.aborted) return\n            onFatalError(err)\n          }\n        }\n\n        const pause = (newPausedState) => {\n          if (!capabilities.resumableUploads) return;\n\n          isPaused = newPausedState\n          if (socket) sendState()\n\n          if (newPausedState) {\n            // Remove this file from the queue so another file can start in its place.\n            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n          } else {\n            // Resuming an upload should be queued, else you could pause and then\n            // resume a queued upload to make it skip the queue.\n            createWebsocket()\n          }\n        }\n\n        const onFileRemove = (targetFile) => {\n          if (!capabilities.individualCancellation) return\n          if (targetFile.id !== file.id) return\n          socketSend('cancel')\n          socketAbortController?.abort?.()\n          this.uppy.log(`upload ${file.id} was removed`, 'info')\n          resolve()\n        }\n\n        const onCancelAll = ({ reason }) => {\n          if (reason === 'user') {\n            socketSend('cancel')\n          }\n          socketAbortController?.abort?.()\n          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n          resolve()\n        };\n\n        const onFilePausedChange = (targetFileId, newPausedState) => {\n          if (targetFileId !== file.id) return\n          pause(newPausedState)\n        }\n\n        const onPauseAll = () => pause(true)\n        const onResumeAll = () => pause(false)\n\n        this.uppy.on('file-removed', onFileRemove)\n        this.uppy.on('cancel-all', onCancelAll)\n        this.uppy.on('upload-pause', onFilePausedChange)\n        this.uppy.on('pause-all', onPauseAll)\n        this.uppy.on('resume-all', onResumeAll)\n\n        removeEventHandlers = () => {\n          this.uppy.off('file-removed', onFileRemove)\n          this.uppy.off('cancel-all', onCancelAll)\n          this.uppy.off('upload-pause', onFilePausedChange)\n          this.uppy.off('pause-all', onPauseAll)\n          this.uppy.off('resume-all', onResumeAll)\n        }\n\n        signal.addEventListener('abort', () => {\n          socketAbortController?.abort();\n        })\n\n        createWebsocket()\n      })\n    } finally {\n      removeEventHandlers?.()\n    }\n  }\n}\n"],"mappings":"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"}